# Cursor MCP設定 & ワークフローガイドライン

このディレクトリには、このプロジェクト専用のCursor MCPサーバー設定が含まれています。

## 🔄 コード変更ワークフロー（必須）

### AIアシスタント作業ルール

**基本原則**:
- **🔴 禁止**: 即時コード編集（修正内容を提案してから、ユーザーの承認を得てからコードに反映すること）
- **✅ 必須**: 提案→承認→実行の順序を守ること

**ワークフロー**:
1. **フェーズ1: 問題分析** - エラーメッセージ、ログ、動作の確認
2. **フェーズ2: 修正提案** - 具体的な修正内容を記述（変更ファイル、内容、期待結果）
3. **フェーズ3: 承認待ち** - ユーザーの承認を待つ
4. **フェーズ4: 実行** - 承認後、コード変更を実行

**リスク別ガイドライン**:
- **🟢 低リスク**: UIテキスト修正、ログ追加（承認不要）
- **🟡 中リスク**: 新機能追加、設定変更（提案・承認必須）
- **🔴 高リスク**: DBスキーマ変更、RLSポリシー変更（提案・承認 + 詳細レビュー）

**重要**: RLSポリシー、データベーススキーマ、セキュリティ関連の変更は必ず提案・承認を経ること。

## 設定ファイル

- `mcp.json`: 現在アクティブなMCPサーバー設定（デフォルト: Staging環境）
- `mcp.json.staging`: Staging環境用のテンプレート
- `mcp.json.dev`: Dev環境用のテンプレート

## 環境切り替え

### 簡単な方法（推奨）

プロジェクトルートで以下のコマンドを実行：

```bash
# Staging環境に切り替え
./scripts/switch-mcp-env.sh staging

# Dev環境に切り替え
./scripts/switch-mcp-env.sh dev
```

### 手動で切り替える場合

```bash
# Staging環境
cp .cursor/mcp.json.staging .cursor/mcp.json

# Dev環境
cp .cursor/mcp.json.dev .cursor/mcp.json
```

## 現在の環境

- **Staging**: `wioealhsienyubwegvdu` (デフォルト)
- **Dev**: `bpmarxvgryqhjfmqqdlg`

## 注意事項

- プロジェクトレベルの設定（`.cursor/mcp.json`）は、グローバル設定（`~/.cursor/mcp.json`）よりも優先されます
- 環境を切り替えた後は、**Cursorを再起動**してください
- この設定ファイルはプロジェクトごとに独立しているため、他のプロジェクトに影響しません
- `mcp.json` はGit管理に含まれます（デフォルトはStaging環境）
